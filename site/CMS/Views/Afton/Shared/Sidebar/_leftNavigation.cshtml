@using CMS.Helpers
@using CMS.Mvc.Helpers
@model CMS.Mvc.ViewModels.Shared.SidebarComponents.LeftNavigationViewModel
<div id="sidebarHdrC" class="
     @if(!Model.HasHero) {
         @UtilsHelper.ToHtmlString("altSidbarstyles");
         }
         "> <h2>@UtilsHelper.ToHtmlString(Model.Title)</h2>
</div>
<div id="sidebarNavC">
    <ul>
        @foreach (var navItem in Model.NavItems)
        {
            if (navItem.SubMenu != null && navItem.SubMenu.Count() > 0)
            {
                <li>
                    @if (navItem.Link != null)
                    {
                        <a href="@Url.Content("~/" + navItem.Link)" class="open active">
                                                @if (!string.IsNullOrEmpty(navItem.NavigationIcon))
                                                {
                                                    <img src="@Url.Content(navItem.NavigationIcon))" />
                                                }
                        @UtilsHelper.ToHtmlString(navItem.Title)</a>
                    }
                    else
                    {
                        <a>
                            @if (!string.IsNullOrEmpty(navItem.NavigationIcon))
                            {
                                <img src="@Url.Content(navItem.NavigationIcon))" />
                            }
                     @UtilsHelper.ToHtmlString(navItem.Title)</a>
                    }
                    <ul>
                        @foreach (var subNavItem in navItem.SubMenu)
                        {
                            <li>
                                @if (subNavItem.Link != null)
                                {
                                    if (subNavItem.Link == CMS.Helpers.RequestContext.CurrentURL.Substring(1)) { 
                                        <a class="active" href="@Url.Content("~/" + subNavItem.Link)">@UtilsHelper.ToHtmlString(subNavItem.Title)</a>
                                    }
                                    else
                                    {
                                        <a href="@Url.Content("~/" + subNavItem.Link)">@UtilsHelper.ToHtmlString(subNavItem.Title)</a>
                                    }
                                }
                                else
                                {
                                    <a>@UtilsHelper.ToHtmlString(subNavItem.Title)</a>
                                }
                            </li>
                        }
                    </ul>
                </li>
            }
            else
            {
                <li>
                    @if (navItem.Link != null)
                    {
                        if (navItem.Link == CMS.Helpers.RequestContext.CurrentURL.Substring(1))
                        {
                            <a class="open active" href="@Url.Content("~/" + navItem.Link)">
                                @if (!string.IsNullOrEmpty(navItem.NavigationIcon))
                                {
                                    <img src="@Url.Content(navItem.NavigationIcon))" />
                                }
                                @UtilsHelper.ToHtmlString(navItem.Title)</a>
                        }
                        else
                        {
                            <a href="@Url.Content("~/" + navItem.Link)">
                                @if (!string.IsNullOrEmpty(navItem.NavigationIcon))
                                {
                                    <img src="@Url.Content(navItem.NavigationIcon))" />
                                }
                                    @UtilsHelper.ToHtmlString(navItem.Title)</a>
                        }
                    }
                    else
                    {
                        <a>@UtilsHelper.ToHtmlString(navItem.Title)</a>
                    }
                </li>
            }
        }
    </ul>
</div>
