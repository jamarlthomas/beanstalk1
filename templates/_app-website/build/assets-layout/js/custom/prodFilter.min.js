var app=angular.module("prodFilterApp",["angularUtils.directives.dirPagination"]);app.controller("prodFilterCntl",["$scope","$location","$http","$timeout",function(e,t,r,a){e.updateCheckboxItems=function(t,r,a,o){if("undefined"!=typeof a&&-1!=a&&""!=a){for(tempURLArray=a.split(","),retArrayIDs=tempURLArray,retStringIDs=e.arrayToString2(tempURLArray),retArrayText=[],i=0;i<tempURLArray.length;i++)tempModelID=$("#filter"+t+" input[data-id='"+tempURLArray[i]+"']").attr("ng-model"),tempModelID=tempModelID.replace(r,""),tempModelID=tempModelID.replace("[",""),tempModelID=tempModelID.replace("]",""),o[tempModelID]=!0,$("#mFilter"+t+" input[data-id='"+tempURLArray[i]+"']").prop("checked",!0),tempTextValue="",tempTextValue=$("#filter"+t+" input[data-id='"+tempURLArray[i]+"']").parent().find(".txt").html(),retArrayText.push(tempTextValue);var n=e.arrayToString(retArrayText);return[retArrayIDs,retStringIDs,retArrayText,n]}},e.$on("$locationChangeSuccess",function(r,o,n){var i=t.path(),p=i.split("/");if(""==i)t.path("/regions/-1/documents/-1/SBU/-1/solutions/-1/sort/Newest/page/1/search/");else{var u=p[2];e.region=[];var c=e.region;$("#mFilterRegion input").prop("checked",!1);var l=e.updateCheckboxItems("Region","region",u,c);"undefined"!=typeof l?(e.regionArrayID=l[0],e.regionStringID=l[1],e.regionArrayText=l[2],e.regionSelected=l[3]):(e.regionArrayID=[],e.regionStringID="-1",e.regionArrayText=[],e.regionSelected="All");var s=p[4];e.docType=[];var y=e.docType;$("#mFilterDocumentType input").prop("checked",!1);var l=e.updateCheckboxItems("DocumentType","docType",s,y);"undefined"!=typeof l?(e.docTypeArrayID=l[0],e.docTypeStringID=l[1],e.docTypeArrayText=l[2],e.docTypeSelected=l[3]):(e.docTypeArrayID=[],e.docTypeStringID="-1",e.docTypeArrayText=[],e.docTypeSelected="All");var d=p[8];e.solution=[];var g=e.solution;$("#mFilterSolution input").prop("checked",!1);var l=e.updateCheckboxItems("Solution","solution",d,g);"undefined"!=typeof l?(e.solutionArrayID=l[0],e.solutionStringID=l[1],e.solutionArrayText=l[2],e.solutionSelected=l[3]):(e.solutionArrayID=[],e.solutionStringID="-1",e.solutionArrayText=[],e.solutionSelected="All");var m=p[10];"undefined"==typeof m&&(m="Newest"),e.sortItems=m,$("#filterSort .customSelectC ul").find("li[value='"+m+"']").prop("selected",!0),e.mytimeout=a(function(){$("#filterSort .customSelectC .currentItem").text(m)},800);var S=p[12];"undefined"==typeof S&&(S="1"),e.pageNumber=S;var A=p[14];$("#mobileFilterSearch input").attr("value",p[14]),"undefined"==typeof A&&(A=""),e.searchFilter=A,e.runQuery()}}),e.updateArray=function(e,t,r,a){if(r)e.push(t);else{var o=e.indexOf(t);e.splice(o,1)}return e},e.arrayToString=function(e){return tempString="",tempString=e.join(", "),""==tempString&&(tempString="All"),tempString},e.arrayToString2=function(e){return tempString="",tempString=e.join(","),""==tempString&&(tempString="-1"),tempString},e.searchFilter="",e.search=function(t){e.pageNumber="1",e.sortItems="Newest",$("#mobileFilterSearch input").attr("value",t),e.pathUpdate()},e.regionArrayID=[],e.regionStringID="-1",e.regionArrayText=[],e.regionSelected="All",e.regionWatch=function(t,r,a){e.regionArrayID=e.updateArray(e.regionArrayID,t,a),e.regionStringID=e.arrayToString2(e.regionArrayID),e.regionArrayText=e.updateArray(e.regionArrayText,r,a),e.regionSelected=e.arrayToString(e.regionArrayText),e.pageNumber="1",e.sortItems="Newest",e.pathUpdateDebounce()},e.docTypeArrayID=[],e.docTypeStringID="-1",e.docTypeArrayText=[],e.docTypeSelected="All",e.docTypeWatch=function(t,r,a){e.docTypeArrayID=e.updateArray(e.docTypeArrayID,t,a),e.docTypeStringID=e.arrayToString2(e.docTypeArrayID),e.docTypeArrayText=e.updateArray(e.docTypeArrayText,r,a),e.docTypeSelected=e.arrayToString(e.docTypeArrayText),e.pageNumber="1",e.sortItems="Newest",e.pathUpdateDebounce()},e.solutionArrayID=[],e.solutionStringID="-1",e.solutionArrayText=[],e.solutionSelected="All",e.solutionWatch=function(t,r,a){e.solutionArrayID=e.updateArray(e.solutionArrayID,t,a),e.solutionStringID=e.arrayToString2(e.solutionArrayID),e.solutionArrayText=e.updateArray(e.solutionArrayText,r,a),e.solutionSelected=e.arrayToString(e.solutionArrayText),e.pageNumber="1",e.sortItems="Newest",e.pathUpdateDebounce()},e.sortItems="Newest",e.sorting=function(){e.pathUpdate()},$("#filterSort .customSelectC").on("click","li",function(t){var r=$(this).text();e.sortItems=r,e.$apply(e.pathUpdate())}),e.reset=function(){e.searchFilter="",e.regionArrayID=[],e.regionStringID="-1",e.regionArrayText=[],e.regionSelected="All",e.docTypeArrayID=[],e.docTypeStringID="-1",e.docTypeArrayText=[],e.docTypeSelected="All",e.solutionArrayID=[],e.solutionStringID="-1",e.solutionArrayText=[],e.solutionSelected="All",e.sortItems="Newest",e.pageNumber=1,e.pathUpdate()},e.total_count,e.itemsPerpage,e.pageNumber=1,e.pageChanged=function(t){e.pageNumber=t,e.pathUpdateDebounce()},e.pathUpdate=function(){e.pageURL="/",e.pageURL=e.pageURL+"regions/"+e.regionStringID,e.pageURL=e.pageURL+"/documents/"+e.docTypeStringID,e.pageURL=e.pageURL+"/SBU/-1",e.pageURL=e.pageURL+"/solutions/"+e.solutionStringID,e.pageURL=e.pageURL+"/sort/"+e.sortItems,e.pageURL=e.pageURL+"/page/"+e.pageNumber,e.pageURL=e.pageURL+"/search/"+e.searchFilter,t.path(e.pageURL)},e.pathUpdateDebounce=function(){a.cancel(e.mytimeout),e.mytimeout=a(function(){e.pathUpdate()},800)},e.runQuery=function(){e.ajaxRequest="http://localhost:1000/product-filter-angular.html#/",e.ajaxRequest=e.ajaxRequest+"regions/"+e.regionStringID,e.ajaxRequest=e.ajaxRequest+"/documents/"+e.docTypeStringID,e.ajaxRequest=e.ajaxRequest+"/SBU/-1",e.ajaxRequest=e.ajaxRequest+"/solutions/"+e.solutionStringID,e.ajaxRequest=e.ajaxRequest+"/sort/"+e.sortItems,e.ajaxRequest=e.ajaxRequest+"/page/"+e.pageNumber,e.ajaxRequest=e.ajaxRequest+"/search/"+e.searchFilter(function(e,t,r,a,o,n,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,n=t.createElement(r),i=t.getElementsByTagName(r)[0],n.async=1,n.src=a,i.parentNode.insertBefore(n,i)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-10080511-2","auto"),ga("send","pageview");var t="REGIONS = "+e.regionArrayText;t=t+" - DOCUMENTS = "+e.docTypeArrayText,t=t+" - SOLUTIONS = "+e.solutionArrayText,ga("send","event",{eventCategory:"product filter",eventAction:"click",eventLabel:t,transport:"beacon"}),e.dataLoaded=function(){return!1},e.prodfilterResults="",r.get(e.ajaxRequest).then(function(t){e.prodfilterResults=t.data.results,e.total_count=t.data.pagecount,e.itemsPerpage=t.data.itemsPerpage,e.dataLoaded=function(){return!0},a(function(){$(".cardsSM_C .cardsSM .cardTextArea").dotdotdot({ellipsis:"... ",wrap:"word",watch:"window"})}),e.checkForResults=function(){return null===e.prodfilterResults?!0:!1}})},$("#mobileFilterSearch input").bind("enterKey",function(r){mSearchbox=$(this).val(),e.$apply(function(){e.searchFilter=mSearchbox});var a=t.path(),o=a.split("/");e.pageNumber="1",e.sortItems="Newest",e.$apply(t.path("/regions/"+o[2]+"/documents/"+o[4]+"/SBU/"+o[6]+"/solutions/"+o[8]+"/sort/Newest/page/1/search/"+mSearchbox))}),$("#mobileFilterSearch input").keyup(function(e){13==e.keyCode&&$(this).trigger("enterKey")}),$("#mobileFilterNav").on("click","input[type='checkbox']",function(){a.cancel(e.mytimeout2),e.mytimeout2=a(function(){var r=t.path(),a=r.split("/");tempRegURLArray=[],$("#mFilterRegion input:checked").each(function(){tempRegURLArray.push($(this).attr("data-id"))}),URL_RegionNum=e.arrayToString2(tempRegURLArray),tempDocTypeURLArray=[],$("#mFilterDocumentType input:checked").each(function(){tempDocTypeURLArray.push($(this).attr("data-id"))}),URL_DocTypeNum=e.arrayToString2(tempDocTypeURLArray),tempSolutionURLArray=[],$("#mFilterSolution input:checked").each(function(){tempSolutionURLArray.push($(this).attr("data-id"))}),URL_SolutionNum=e.arrayToString2(tempSolutionURLArray),e.pageNumber="1",e.sortItems="Newest",e.$apply(t.path("/regions/"+URL_RegionNum+"/documents/"+URL_DocTypeNum+"/SBU/"+a[6]+"/solutions/"+URL_SolutionNum+"/sort/Newest/page/1/search/"+a[14]))},800)}),$("#mobileFilterForm #mobileClearFilterB input").click(function(){e.$apply(e.reset())})}]);