var app=angular.module("prodFilterApp",["ui.router","angularUtils.directives.dirPagination"]);app.config(["$stateProvider","$urlRouterProvider",function(e,r){e.state("home",{url:"/doc/",controller:"test"})}]),app.controller("prodFilterCntl",["$scope","$location","$http","$timeout",function(e,r,t,a){e.$on("$locationChangeSuccess",function(t,a,o){var n=r.path(),u=n.split("/"),g=u[2];if("undefined"!=typeof g&&-1!=g){for(urlRegionsArray=g.split(","),e.regionArrayID=urlRegionsArray,e.regionArrayIDString=e.arrayToString2(urlRegionsArray),e.regionArrayText=[],e.region=[],i=0;i<urlRegionsArray.length;i++)getModelID=$("#filterRegion input[data-id='"+urlRegionsArray[i]+"']").attr("ng-model"),getModelID=getModelID.replace("region[",""),getModelID=getModelID.replace("]",""),e.region[getModelID]=!0,getRegionValue=$("#filterRegion input[data-id='"+urlRegionsArray[i]+"']").attr("data-text"),e.regionArrayText.push(getRegionValue);e.regionCurrentSelected=e.arrayToString(e.regionArrayText)}e.runQuery()}),e.updateArray=function(e,r,t,a){if(t)e.push(r);else{var o=e.indexOf(r);e.splice(o,1)}return e},e.arrayToString=function(e){return tempString="",tempString=e.join(", "),""==tempString&&(tempString="All"),tempString},e.arrayToString2=function(e){return tempString="",tempString=e.join(","),""==tempString&&(tempString="-1"),tempString},e.searchFilter="",e.search=function(r){e.pathUpdate()},e.regionArrayID=[],e.regionArrayIDString="-1",e.regionArrayText=[],e.regionCurrentSelected="All",e.regionWatch=function(r,t,a){e.regionArrayID=e.updateArray(e.regionArrayID,r,a),e.regionArrayIDString=e.arrayToString2(e.regionArrayID),e.regionArrayText=e.updateArray(e.regionArrayText,t,a),e.regionCurrentSelected=e.arrayToString(e.regionArrayText),e.pathUpdateDebounce()},e.docTypeArrayID=[],e.docTypeArrayIDString="-1",e.docTypeArrayText=[],e.docTypeCurrentSelected="All",e.docTypeWatch=function(r,t,a){e.docTypeArrayID=e.updateArray(e.docTypeArrayID,r,a),e.docTypeArrayIDString=e.arrayToString2(e.docTypeArrayID),e.docTypeArrayText=e.updateArray(e.docTypeArrayText,t,a),e.docTypeCurrentSelected=e.arrayToString(e.docTypeArrayText),e.pathUpdateDebounce()},e.solutionArrayID=[],e.solutionArrayIDString="-1",e.solutionArrayText=[],e.solutionCurrentSelected="All",e.solutionWatch=function(r,t,a){e.solutionArrayID=e.updateArray(e.solutionArrayID,r,a),e.solutionArrayIDString=e.arrayToString2(e.solutionArrayID),e.solutionArrayText=e.updateArray(e.solutionArrayText,t,a),e.solutionCurrentSelected=e.arrayToString(e.solutionArrayText),e.pathUpdateDebounce()},e.sortItems="Newest",e.sorting=function(){console.log("sort"),e.pathUpdate()},$("#filterSort .customSelectC").on("click","li",function(r){var t=$(this).text();e.sortItems=t,e.$apply(e.pathUpdate())}),e.reset=function(){e.searchFilter="",e.regionArrayID=[],e.regionArrayIDString="-1",e.regionArrayText=[],e.regionCurrentSelected="All",e.docTypeArrayID=[],e.docTypeArrayIDString="-1",e.docTypeArrayText=[],e.docTypeCurrentSelected="All",e.solutionArrayID=[],e.solutionArrayIDString="-1",e.solutionArrayText=[],e.solutionCurrentSelected="All",e.sortItems="Newest",e.pageNumber=1,e.pathUpdate()},e.total_count,e.itemsPerpage,e.pageNumber=1,e.pageChanged=function(r){e.pageNumber=r,e.pathUpdateDebounce()},e.pathUpdate=function(){e.pageURL="/",e.pageURL=e.pageURL+"regions/"+e.regionArrayIDString,e.pageURL=e.pageURL+"/documents/"+e.docTypeArrayIDString,e.pageURL=e.pageURL+"/SBU/-1",e.pageURL=e.pageURL+"/solutions/"+e.solutionArrayIDString,e.pageURL=e.pageURL+"/sort/"+e.sortItems,e.pageURL=e.pageURL+"/page/"+e.pageNumber,e.pageURL=e.pageURL+"/search/"+e.searchFilter,r.path(e.pageURL)},e.pathUpdateDebounce=function(){a.cancel(e.mytimeout),e.mytimeout=a(function(){e.pathUpdate()},800)},e.runQuery=function(){e.ajaxRequest="http://localhost:51872/filter/",e.ajaxRequest=e.ajaxRequest+"regions/"+e.regionArrayIDString,e.ajaxRequest=e.ajaxRequest+"/documents/"+e.docTypeArrayIDString,e.ajaxRequest=e.ajaxRequest+"/SBU/-1",e.ajaxRequest=e.ajaxRequest+"/solutions/"+e.solutionArrayIDString,e.ajaxRequest=e.ajaxRequest+"/sort/"+e.sortItems,e.ajaxRequest=e.ajaxRequest+"/page/"+e.pageNumber,e.ajaxRequest=e.ajaxRequest+"/search/"+e.searchFilter,e.dataLoaded=function(){return!1},e.prodfilterResults="",t.get(e.ajaxRequest).then(function(r){e.prodfilterResults=r.data.results,e.total_count=r.data.pagecount,e.itemsPerpage=r.data.itemsPerpage,e.dataLoaded=function(){return!0},e.checkForResults=function(){return console.log("test"),null===e.prodfilterResults?!0:!1}})}}]);