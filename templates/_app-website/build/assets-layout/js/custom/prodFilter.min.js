var app=angular.module("prodFilterApp",["angularUtils.directives.dirPagination"]);app.controller("prodFilterCntl",["$scope","$location","$http","$timeout",function(e,t,r,a){e.updateCheckboxItems=function(t,r,a,o){if("undefined"!=typeof a&&-1!=a&&""!=a){for(tempURLArray=a.split(","),retArrayIDs=tempURLArray,retStringIDs=e.arrayToString2(tempURLArray),retArrayText=[],i=0;i<tempURLArray.length;i++)tempModelID=$(t+" input[data-id='"+tempURLArray[i]+"']").attr("ng-model"),tempModelID=tempModelID.replace(r,""),tempModelID=tempModelID.replace("[",""),tempModelID=tempModelID.replace("]",""),o[tempModelID]=!0,tempTextValue=$("#filterRegion input[data-id='"+tempURLArray[i]+"']").attr("data-text"),retArrayText.push(tempTextValue);var n=e.arrayToString(retArrayText);return[retArrayIDs,retStringIDs,retArrayText,n]}},e.$on("$locationChangeSuccess",function(r,o,n){var i=t.path(),p=i.split("/"),u=p[2];e.region=[];var l=e.region,s=e.updateCheckboxItems("#filterRegion","region",u,l);"undefined"!=typeof s&&(e.regionArrayID=s[0],e.regionStringID=s[1],e.regionArrayText=s[2],e.regionSelected=s[3]);var c=p[4];e.docType=[];var g=e.docType,s=e.updateCheckboxItems("#filterDocumentType","docType",c,g);"undefined"!=typeof s&&(e.docTypeArrayID=s[0],e.docTypeStringID=s[1],e.docTypeArrayText=s[2],e.docTypeSelected=s[3]);var d=p[8];e.solution=[];var y=e.solution,s=e.updateCheckboxItems("#filterSolution","solution",d,y);"undefined"!=typeof s&&(e.solutionArrayID=s[0],e.solutionStringID=s[1],e.solutionArrayText=s[2],e.solutionSelected=s[3]);var A=p[10];e.sortItems=A,$("#filterSort .customSelectC ul").find("li[value='"+A+"']").prop("selected",!0),e.mytimeout=a(function(){$("#filterSort .customSelectC .currentItem").text(A)},800);var S=p[12];e.pageNumber=S;var m=p[14];e.searchFilter=m,e.runQuery()}),e.updateArray=function(e,t,r,a){if(r)e.push(t);else{var o=e.indexOf(t);e.splice(o,1)}return e},e.arrayToString=function(e){return tempString="",tempString=e.join(", "),""==tempString&&(tempString="All"),tempString},e.arrayToString2=function(e){return tempString="",tempString=e.join(","),""==tempString&&(tempString="-1"),tempString},e.searchFilter="",e.search=function(t){e.pathUpdate()},e.regionArrayID=[],e.regionStringID="-1",e.regionArrayText=[],e.regionSelected="All",e.regionWatch=function(t,r,a){e.regionArrayID=e.updateArray(e.regionArrayID,t,a),e.regionStringID=e.arrayToString2(e.regionArrayID),e.regionArrayText=e.updateArray(e.regionArrayText,r,a),e.regionSelected=e.arrayToString(e.regionArrayText),e.pathUpdateDebounce()},e.docTypeArrayID=[],e.docTypeStringID="-1",e.docTypeArrayText=[],e.docTypeSelected="All",e.docTypeWatch=function(t,r,a){e.docTypeArrayID=e.updateArray(e.docTypeArrayID,t,a),e.docTypeStringID=e.arrayToString2(e.docTypeArrayID),e.docTypeArrayText=e.updateArray(e.docTypeArrayText,r,a),e.docTypeSelected=e.arrayToString(e.docTypeArrayText),e.pathUpdateDebounce()},e.solutionArrayID=[],e.solutionStringID="-1",e.solutionArrayText=[],e.solutionSelected="All",e.solutionWatch=function(t,r,a){e.solutionArrayID=e.updateArray(e.solutionArrayID,t,a),e.solutionStringID=e.arrayToString2(e.solutionArrayID),e.solutionArrayText=e.updateArray(e.solutionArrayText,r,a),e.solutionSelected=e.arrayToString(e.solutionArrayText),e.pathUpdateDebounce()},e.sortItems="Newest",e.sorting=function(){e.pathUpdate()},$("#filterSort .customSelectC").on("click","li",function(t){var r=$(this).text();e.sortItems=r,e.$apply(e.pathUpdate())}),e.reset=function(){e.searchFilter="",e.regionArrayID=[],e.regionStringID="-1",e.regionArrayText=[],e.regionSelected="All",e.docTypeArrayID=[],e.docTypeStringID="-1",e.docTypeArrayText=[],e.docTypeSelected="All",e.solutionArrayID=[],e.solutionStringID="-1",e.solutionArrayText=[],e.solutionSelected="All",e.sortItems="Newest",e.pageNumber=1,e.pathUpdate()},e.total_count,e.itemsPerpage,e.pageNumber=1,e.pageChanged=function(t){e.pageNumber=t,e.pathUpdateDebounce()},e.pathUpdate=function(){e.pageURL="/",e.pageURL=e.pageURL+"regions/"+e.regionStringID,e.pageURL=e.pageURL+"/documents/"+e.docTypeStringID,e.pageURL=e.pageURL+"/SBU/-1",e.pageURL=e.pageURL+"/solutions/"+e.solutionStringID,e.pageURL=e.pageURL+"/sort/"+e.sortItems,e.pageURL=e.pageURL+"/page/"+e.pageNumber,e.pageURL=e.pageURL+"/search/"+e.searchFilter,t.path(e.pageURL)},e.pathUpdateDebounce=function(){a.cancel(e.mytimeout),e.mytimeout=a(function(){e.pathUpdate()},800)},e.runQuery=function(){e.ajaxRequest="http://localhost:51872/filter/",e.ajaxRequest=e.ajaxRequest+"regions/"+e.regionStringID,e.ajaxRequest=e.ajaxRequest+"/documents/"+e.docTypeStringID,e.ajaxRequest=e.ajaxRequest+"/SBU/-1",e.ajaxRequest=e.ajaxRequest+"/solutions/"+e.solutionStringID,e.ajaxRequest=e.ajaxRequest+"/sort/"+e.sortItems,e.ajaxRequest=e.ajaxRequest+"/page/"+e.pageNumber,e.ajaxRequest=e.ajaxRequest+"/search/"+e.searchFilter,e.dataLoaded=function(){return!1},e.prodfilterResults="",r.get(e.ajaxRequest).then(function(t){e.prodfilterResults=t.data.results,e.total_count=t.data.pagecount,e.itemsPerpage=t.data.itemsPerpage,e.dataLoaded=function(){return!0},e.checkForResults=function(){return console.log("test"),null===e.prodfilterResults?!0:!1}})}}]);